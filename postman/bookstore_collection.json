{
    "info": {
        "_postman_id": "b00k570r-3-4p1-c011-3c71-0n",
        "name": "서점(Bookstore) API",
        "description": "Bookstore OpenAPI 스펙 기반 Postman 컬렉션 (토큰 저장/주입, 응답 검증 스크립트 포함)",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "event": [
        {
            "listen": "prerequest",
            "script": {
                "type": "text/javascript",
                "exec": [
                    "// === Global Pre-request Script (Bookstore API) ===",
                    "// 1) baseUrl 정규화 (끝의 '/' 제거)",
                    "let baseUrl = pm.variables.get('baseUrl');",
                    "if (baseUrl && baseUrl.endsWith('/')) {",
                    "  baseUrl = baseUrl.slice(0, -1);",
                    "  if (pm.collectionVariables) pm.collectionVariables.set('baseUrl', baseUrl);",
                    "}",
                    "",
                    "// 2) JSON 바디가 있는 요청이면 Content-Type 자동 주입",
                    "const m = pm.request.method;",
                    "const hasBody = ['POST','PUT','PATCH'].includes(m);",
                    "if (hasBody) {",
                    "  const ct = pm.request.headers.get('Content-Type');",
                    "  if (!ct) pm.request.headers.upsert({ key: 'Content-Type', value: 'application/json' });",
                    "}",
                    "",
                    "// 3) authScope에 따라 Authorization 자동 주입 (admin/user)",
                    "//    - 폴더(또는 요청) 변수로 authScope='admin' | 'user'를 지정해두면 자동으로 토큰을 선택합니다.",
                    "//    - 이미 Authorization 헤더가 있으면 건드리지 않습니다.",
                    "const urlStr = pm.request.url.toString();",
                    "const isPublic = urlStr.includes('/api/auth/login') || urlStr.includes('/api/auth/signup') || urlStr.includes('/health') || urlStr.includes('/actuator') || urlStr.includes('/h2-console');",
                    "if (!isPublic) {",
                    "  const already = pm.request.headers.get('Authorization');",
                    "  if (!already) {",
                    "    const scope = pm.variables.get('authScope'); // folder/request-scoped variable",
                    "    let t = null;",
                    "    if (scope === 'admin') {",
                    "      t = (pm.collectionVariables && pm.collectionVariables.get('adminToken')) || (pm.environment && pm.environment.get('adminToken'));",
                    "    } else if (scope === 'user') {",
                    "      t = (pm.collectionVariables && pm.collectionVariables.get('token')) || (pm.environment && pm.environment.get('token'));",
                    "    }",
                    "    if (t) {",
                    "      pm.request.headers.upsert({ key: 'Authorization', value: 'Bearer ' + t });",
                    "    }",
                    "  }",
                    "}"
                ]
            }
        },
        {
            "listen": "test",
            "script": {
                "type": "text/javascript",
                "exec": [
                    "// === Global Test Script (Bookstore API) ===",
                    "// 1) 응답 시간 기본 검증 (너무 빡세게 잡지 않기)",
                    "pm.test('Response time < 5000ms', function () {",
                    "  pm.expect(pm.response.responseTime).to.be.below(5000);",
                    "});",
                    "",
                    "// 2) 2xx이면 JSON 파싱 가능해야 함(가능한 경우)",
                    "if (pm.response.code >= 200 && pm.response.code < 300) {",
                    "  const ct = (pm.response.headers.get('Content-Type') || '').toLowerCase();",
                    "  if (ct.includes('application/json')) {",
                    "    pm.test('2xx response is valid JSON', function () {",
                    "      pm.response.to.be.json;",
                    "    });",
                    "  }",
                    "}",
                    "",
                    "// 3) 4xx/5xx이면 에러 바디가 JSON이면 파싱 시도(실패해도 테스트는 통과)",
                    "if (pm.response.code >= 400) {",
                    "  try { pm.response.json(); } catch (e) {}",
                    "}"
                ]
            }
        }
    ],
    "item": [
        {
            "name": "관리자(Admin)",
            "variable": [
                {
                    "key": "authScope",
                    "value": "admin",
                    "type": "string"
                }
            ],
            "item": [
                {
                    "name": "관리자 로그인",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/auth/login",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"{{adminEmail}}\",\n  \"password\": \"{{adminPassword}}\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "// === Token Extract Test (adminToken) ===",
                                    "let accessToken = null;",
                                    "let refreshToken = null;",
                                    "",
                                    "// 1) JSON 바디에서 accessToken 추출 (payload.accessToken)",
                                    "try {",
                                    "  const jsonData = pm.response.json();",
                                    "  if (jsonData && jsonData.payload && jsonData.payload.accessToken) {",
                                    "    accessToken = jsonData.payload.accessToken;",
                                    "  }",
                                    "} catch (e) {}",
                                    "",
                                    "// 2) Authorization 헤더에서 Bearer 토큰 추출 (fallback)",
                                    "if (!accessToken) {",
                                    "  const authHeader = pm.response.headers.get('Authorization');",
                                    "  if (authHeader && authHeader.startsWith('Bearer ')) {",
                                    "    accessToken = authHeader.substring(7);",
                                    "  }",
                                    "}",
                                    "",
                                    "// 3) Set-Cookie에서 refresh_token 추출 (있으면 저장)",
                                    "const setCookie = pm.response.headers.get('Set-Cookie');",
                                    "if (setCookie) {",
                                    "  // 단일/복수 Set-Cookie가 합쳐져 들어오는 케이스 대비",
                                    "  const m = setCookie.match(/refresh_token=([^;]+)/);",
                                    "  if (m && m[1]) refreshToken = m[1];",
                                    "}",
                                    "",
                                    "// 4) 저장",
                                    "if (accessToken) {",
                                    "  if (pm.collectionVariables) pm.collectionVariables.set('adminToken', accessToken);",
                                    "  if (pm.environment) { try { pm.environment.set('adminToken', accessToken); } catch (e) {} }",
                                    "  console.log('adminToken 저장 완료:', accessToken);",
                                    "} else {",
                                    "  console.warn('adminToken을(를) 찾지 못했습니다.');",
                                    "}",
                                    "",
                                    "if (refreshToken) {",
                                    "  if (pm.collectionVariables) pm.collectionVariables.set('refresh_token', refreshToken);",
                                    "  if (pm.environment) { try { pm.environment.set('refresh_token', refreshToken); } catch (e) {} }",
                                    "  console.log('refresh_token 저장 완료:', refreshToken);",
                                    "}",
                                    "",
                                    "// 5) 기본 응답 검증",
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.response.to.have.status(200);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "도서 관리",
                    "item": [
                        {
                            "name": "도서 등록",
                            "request": {
                                "method": "POST",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    }
                                ],
                                "url": "{{baseUrl}}/api/books",
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n  \"isbn13\": \"{{adminBookIsbn13}}\",\n  \"title\": \"{{adminBookTitle}}\",\n  \"description\": \"관리자 등록용 도서 설명\",\n  \"price\": 36000,\n  \"stockQuantity\": 100,\n  \"publishedAt\": \"2018-11-01T00:00:00Z\",\n  \"publisherId\": 1,\n  \"authorIds\": [1],\n  \"categoryIds\": [10]\n}",
                                    "options": {
                                        "raw": {
                                            "language": "json"
                                        }
                                    }
                                }
                            },
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "type": "text/javascript",
                                        "exec": [
                                            "pm.test('Status code is 200 또는 201', function () {",
                                            "  pm.expect([200, 201]).to.include(pm.response.code);",
                                            "});"
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "name": "도서 수정",
                            "request": {
                                "method": "PUT",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    }
                                ],
                                "url": "{{baseUrl}}/api/books/1",
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n  \"title\": \"도서 제목(수정)\",\n  \"description\": \"도서 설명(수정)\",\n  \"price\": 40000,\n  \"stockQuantity\": 80,\n  \"publishedAt\": \"2019-01-01T00:00:00Z\",\n  \"publisherId\": 1,\n  \"authorIds\": [1],\n  \"categoryIds\": [10]\n}",
                                    "options": {
                                        "raw": {
                                            "language": "json"
                                        }
                                    }
                                }
                            },
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "type": "text/javascript",
                                        "exec": [
                                            "pm.test('Status code is 200', function () {",
                                            "  pm.expect([200]).to.include(pm.response.code);",
                                            "});"
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "name": "도서 삭제",
                            "request": {
                                "method": "DELETE",
                                "header": [],
                                "url": "{{baseUrl}}/api/books/1"
                            },
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "type": "text/javascript",
                                        "exec": [
                                            "pm.test('Status code is 200 또는 204', function () {",
                                            "  pm.expect([200, 204]).to.include(pm.response.code);",
                                            "});"
                                        ]
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "출판사 관리",
                    "item": [
                        {
                            "name": "출판사 등록",
                            "request": {
                                "method": "POST",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    }
                                ],
                                "url": "{{baseUrl}}/api/publishers",
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n  \"name\": \"{{adminPublisherName}}\"\n}",
                                    "options": {
                                        "raw": {
                                            "language": "json"
                                        }
                                    }
                                }
                            },
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "type": "text/javascript",
                                        "exec": [
                                            "pm.test('Status code is 200 또는 201', function () {",
                                            "  pm.expect([200, 201]).to.include(pm.response.code);",
                                            "});"
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "name": "출판사 수정",
                            "request": {
                                "method": "PUT",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    }
                                ],
                                "url": "{{baseUrl}}/api/publishers/1",
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n  \"name\": \"출판사명(수정)\"\n}",
                                    "options": {
                                        "raw": {
                                            "language": "json"
                                        }
                                    }
                                }
                            },
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "type": "text/javascript",
                                        "exec": [
                                            "pm.test('Status code is 200', function () {",
                                            "  pm.expect([200]).to.include(pm.response.code);",
                                            "});"
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "name": "출판사 삭제",
                            "request": {
                                "method": "DELETE",
                                "header": [],
                                "url": "{{baseUrl}}/api/publishers/1"
                            },
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "type": "text/javascript",
                                        "exec": [
                                            "pm.test('Status code is 200 또는 204', function () {",
                                            "  pm.expect([200, 204]).to.include(pm.response.code);",
                                            "});"
                                        ]
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "카테고리 관리",
                    "item": [
                        {
                            "name": "카테고리 등록",
                            "request": {
                                "method": "POST",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    }
                                ],
                                "url": "{{baseUrl}}/api/categories",
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n  \"name\": \"{{adminCategoryName}}\"\n}",
                                    "options": {
                                        "raw": {
                                            "language": "json"
                                        }
                                    }
                                }
                            },
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "type": "text/javascript",
                                        "exec": [
                                            "pm.test('Status code is 200 또는 201', function () {",
                                            "  pm.expect([200, 201]).to.include(pm.response.code);",
                                            "});"
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "name": "카테고리 수정",
                            "request": {
                                "method": "PUT",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    }
                                ],
                                "url": "{{baseUrl}}/api/categories/1",
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n  \"name\": \"카테고리명(수정)\"\n}",
                                    "options": {
                                        "raw": {
                                            "language": "json"
                                        }
                                    }
                                }
                            },
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "type": "text/javascript",
                                        "exec": [
                                            "pm.test('Status code is 200', function () {",
                                            "  pm.expect([200]).to.include(pm.response.code);",
                                            "});"
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "name": "카테고리 삭제",
                            "request": {
                                "method": "DELETE",
                                "header": [],
                                "url": "{{baseUrl}}/api/categories/1"
                            },
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "type": "text/javascript",
                                        "exec": [
                                            "pm.test('Status code is 200 또는 204', function () {",
                                            "  pm.expect([200, 204]).to.include(pm.response.code);",
                                            "});"
                                        ]
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "작가 관리",
                    "item": [
                        {
                            "name": "작가 등록",
                            "request": {
                                "method": "POST",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    }
                                ],
                                "url": "{{baseUrl}}/api/authors",
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n  \"name\": \"{{adminAuthorName}}\",\n  \"bio\": \"작가 소개(등록)\"\n}",
                                    "options": {
                                        "raw": {
                                            "language": "json"
                                        }
                                    }
                                }
                            },
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "type": "text/javascript",
                                        "exec": [
                                            "pm.test('Status code is 200 또는 201', function () {",
                                            "  pm.expect([200, 201]).to.include(pm.response.code);",
                                            "});"
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "name": "작가 수정",
                            "request": {
                                "method": "PUT",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    }
                                ],
                                "url": "{{baseUrl}}/api/authors/1",
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n  \"name\": \"작가명(수정)\",\n  \"bio\": \"작가 소개(수정)\"\n}",
                                    "options": {
                                        "raw": {
                                            "language": "json"
                                        }
                                    }
                                }
                            },
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "type": "text/javascript",
                                        "exec": [
                                            "pm.test('Status code is 200', function () {",
                                            "  pm.expect([200]).to.include(pm.response.code);",
                                            "});"
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "name": "작가 삭제",
                            "request": {
                                "method": "DELETE",
                                "header": [],
                                "url": "{{baseUrl}}/api/authors/1"
                            },
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "type": "text/javascript",
                                        "exec": [
                                            "pm.test('Status code is 200 또는 204', function () {",
                                            "  pm.expect([200, 204]).to.include(pm.response.code);",
                                            "});"
                                        ]
                                    }
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "인증(Auth)",
            "item": [
                {
                    "name": "회원가입",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/auth/signup",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"test@example.com\",\n  \"password\": \"password123\",\n  \"username\": \"홍길동\",\n  \"address\": \"서울시 강남구 역삼동\",\n  \"phoneNumber\": \"010-1234-5678\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200 또는 201 또는 409', function () {",
                                    "  pm.expect([200, 201, 409]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "로그인",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/auth/login",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"test@example.com\",\n  \"password\": \"password123\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "// === Token Extract Test (token) ===",
                                    "let accessToken = null;",
                                    "let refreshToken = null;",
                                    "",
                                    "// 1) JSON 바디에서 accessToken 추출 (payload.accessToken)",
                                    "try {",
                                    "  const jsonData = pm.response.json();",
                                    "  if (jsonData && jsonData.payload && jsonData.payload.accessToken) {",
                                    "    accessToken = jsonData.payload.accessToken;",
                                    "  }",
                                    "} catch (e) {}",
                                    "",
                                    "// 2) Authorization 헤더에서 Bearer 토큰 추출 (fallback)",
                                    "if (!accessToken) {",
                                    "  const authHeader = pm.response.headers.get('Authorization');",
                                    "  if (authHeader && authHeader.startsWith('Bearer ')) {",
                                    "    accessToken = authHeader.substring(7);",
                                    "  }",
                                    "}",
                                    "",
                                    "// 3) Set-Cookie에서 refresh_token 추출 (있으면 저장)",
                                    "const setCookie = pm.response.headers.get('Set-Cookie');",
                                    "if (setCookie) {",
                                    "  // 단일/복수 Set-Cookie가 합쳐져 들어오는 케이스 대비",
                                    "  const m = setCookie.match(/refresh_token=([^;]+)/);",
                                    "  if (m && m[1]) refreshToken = m[1];",
                                    "}",
                                    "",
                                    "// 4) 저장",
                                    "if (accessToken) {",
                                    "  if (pm.collectionVariables) pm.collectionVariables.set('token', accessToken);",
                                    "  if (pm.environment) { try { pm.environment.set('token', accessToken); } catch (e) {} }",
                                    "  console.log('token 저장 완료:', accessToken);",
                                    "} else {",
                                    "  console.warn('token을(를) 찾지 못했습니다.');",
                                    "}",
                                    "",
                                    "if (refreshToken) {",
                                    "  if (pm.collectionVariables) pm.collectionVariables.set('refresh_token', refreshToken);",
                                    "  if (pm.environment) { try { pm.environment.set('refresh_token', refreshToken); } catch (e) {} }",
                                    "  console.log('refresh_token 저장 완료:', refreshToken);",
                                    "}",
                                    "",
                                    "// 5) 기본 응답 검증",
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.response.to.have.status(200);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "로그아웃",
                    "request": {
                        "method": "POST",
                        "header": [],
                        "url": "{{baseUrl}}/api/auth/logout"
                    },
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.variables.set('authScope','user');"
                                ]
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "// === Logout Test ===",
                                    "pm.test('Status code is 200 or 204', function () {",
                                    "  pm.expect([200,204]).to.include(pm.response.code);",
                                    "});",
                                    "",
                                    "// 로그아웃 이후 토큰/리프레시 토큰 초기화",
                                    "if (pm.collectionVariables) {",
                                    "  pm.collectionVariables.unset('token');",
                                    "  pm.collectionVariables.unset('refresh_token');",
                                    "}",
                                    "if (pm.environment) {",
                                    "  try { pm.environment.unset('token'); } catch (e) {}",
                                    "  try { pm.environment.unset('refresh_token'); } catch (e) {}",
                                    "}",
                                    "console.log('token/refresh_token cleared');"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "토큰 재발급(리프레시 토큰 쿠키)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Cookie",
                                "value": "refresh_token={{refresh_token}}"
                            }
                        ],
                        "url": "{{baseUrl}}/api/auth/reissue"
                    },
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "// === Reissue Pre-request ===",
                                    "// refresh_token 변수를 Cookie 헤더에 자동 주입",
                                    "const rt = (pm.collectionVariables && pm.collectionVariables.get('refresh_token')) || (pm.environment && pm.environment.get('refresh_token')) || pm.variables.get('refresh_token');",
                                    "if (rt) {",
                                    "  pm.request.headers.upsert({ key: 'Cookie', value: 'refresh_token=' + rt });",
                                    "} else {",
                                    "  console.warn('refresh_token 변수가 비어있습니다. 로그인/재발급 응답에서 Set-Cookie를 저장했는지 확인하세요.');",
                                    "}"
                                ]
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "// === Reissue Test ===",
                                    "pm.test('Status code is 200 or 401', function () {",
                                    "  pm.expect([200,401]).to.include(pm.response.code);",
                                    "});",
                                    "",
                                    "// 200이면 새 accessToken/refresh_token 갱신",
                                    "if (pm.response.code === 200) {",
                                    "  let newToken = null;",
                                    "  try {",
                                    "    const jsonData = pm.response.json();",
                                    "    if (jsonData && jsonData.payload && jsonData.payload.accessToken) newToken = jsonData.payload.accessToken;",
                                    "  } catch (e) {}",
                                    "  if (!newToken) {",
                                    "    const authHeader = pm.response.headers.get('Authorization');",
                                    "    if (authHeader && authHeader.startsWith('Bearer ')) newToken = authHeader.substring(7);",
                                    "  }",
                                    "  const setCookie = pm.response.headers.get('Set-Cookie');",
                                    "  if (setCookie) {",
                                    "    const m = setCookie.match(/refresh_token=([^;]+)/);",
                                    "    if (m && m[1]) {",
                                    "      if (pm.collectionVariables) pm.collectionVariables.set('refresh_token', m[1]);",
                                    "      if (pm.environment) { try { pm.environment.set('refresh_token', m[1]); } catch (e) {} }",
                                    "    }",
                                    "  }",
                                    "  if (newToken) {",
                                    "    if (pm.collectionVariables) pm.collectionVariables.set('token', newToken);",
                                    "    if (pm.environment) { try { pm.environment.set('token', newToken); } catch (e) {} }",
                                    "    console.log('token 갱신 완료:', newToken);",
                                    "  }",
                                    "}"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "사용자(Users)",
            "variable": [
                {
                    "key": "authScope",
                    "value": "user",
                    "type": "string"
                }
            ],
            "item": [
                {
                    "name": "내 정보 조회",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": "{{baseUrl}}/api/users/me"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "내 정보 수정",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/users/me",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"username\": \"김철수\",\n  \"address\": \"서울시 강남구 역삼동\",\n  \"phoneNumber\": \"010-5678-1234\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "비밀번호 변경",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/users/me/password",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"password\": \"newpassword123\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "회원 탈퇴",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": "{{baseUrl}}/api/users/me"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200 또는 204', function () {",
                                    "  pm.expect([200, 204]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "도서(Books)",
            "item": [
                {
                    "name": "도서 검색",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/api/books?page=0&size=10&keyword=&categoryId=&authorId=&publisherId=",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "books"
                            ],
                            "query": [
                                {
                                    "key": "page",
                                    "value": "0"
                                },
                                {
                                    "key": "size",
                                    "value": "10"
                                },
                                {
                                    "key": "keyword",
                                    "value": ""
                                },
                                {
                                    "key": "categoryId",
                                    "value": ""
                                },
                                {
                                    "key": "authorId",
                                    "value": ""
                                },
                                {
                                    "key": "publisherId",
                                    "value": ""
                                }
                            ]
                        }
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "도서 상세 조회",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": "{{baseUrl}}/api/books/1"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "장바구니(Carts)",
            "variable": [
                {
                    "key": "authScope",
                    "value": "user",
                    "type": "string"
                }
            ],
            "item": [
                {
                    "name": "내 장바구니 조회",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": "{{baseUrl}}/api/carts/my"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "장바구니 항목 추가",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/carts/items",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"bookId\": 1,\n  \"quantity\": 2\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200 또는 201', function () {",
                                    "  pm.expect([200, 201]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "장바구니 항목 수량 변경",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/carts/items/1",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"quantity\": 5\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "장바구니 항목 삭제",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": "{{baseUrl}}/api/carts/items/1"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200 또는 204', function () {",
                                    "  pm.expect([200, 204]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "장바구니 비우기",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": "{{baseUrl}}/api/carts/my"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200 또는 204', function () {",
                                    "  pm.expect([200, 204]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "주문(Orders)",
            "variable": [
                {
                    "key": "authScope",
                    "value": "user",
                    "type": "string"
                }
            ],
            "item": [
                {
                    "name": "주문 생성(체크아웃)",
                    "request": {
                        "method": "POST",
                        "header": [],
                        "url": "{{baseUrl}}/api/orders/checkout"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200 또는 201', function () {",
                                    "  pm.expect([200, 201]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "내 주문 내역 조회",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/api/orders/me?page=0&size=10",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "orders",
                                "me"
                            ],
                            "query": [
                                {
                                    "key": "page",
                                    "value": "0"
                                },
                                {
                                    "key": "size",
                                    "value": "10"
                                }
                            ]
                        }
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "주문 상세 조회",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": "{{baseUrl}}/api/orders/1"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "주문 취소",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": "{{baseUrl}}/api/orders/1"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200 또는 204', function () {",
                                    "  pm.expect([200, 204]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "리뷰(Reviews)",
            "variable": [
                {
                    "key": "authScope",
                    "value": "user",
                    "type": "string"
                }
            ],
            "item": [
                {
                    "name": "도서 리뷰 목록 조회",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.variables.set('authScope','');"
                                ]
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/api/books/1/reviews?page=0&size=10",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "books",
                                "1",
                                "reviews"
                            ],
                            "query": [
                                {
                                    "key": "page",
                                    "value": "0"
                                },
                                {
                                    "key": "size",
                                    "value": "10"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "리뷰 작성",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/books/1/reviews",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"rating\": 5,\n  \"content\": \"정말 유익한 책입니다!\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200 또는 201', function () {",
                                    "  pm.expect([200, 201]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "내 리뷰 조회",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/api/reviews/me?page=0&size=10",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "reviews",
                                "me"
                            ],
                            "query": [
                                {
                                    "key": "page",
                                    "value": "0"
                                },
                                {
                                    "key": "size",
                                    "value": "10"
                                }
                            ]
                        }
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "리뷰 수정",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/reviews/1",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"rating\": 4,\n  \"content\": \"다시 읽어보니 조금 아쉬운 점이 있네요.\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "리뷰 삭제",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": "{{baseUrl}}/api/reviews/1"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200 또는 204', function () {",
                                    "  pm.expect([200, 204]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "리뷰 좋아요",
                    "request": {
                        "method": "POST",
                        "header": [],
                        "url": "{{baseUrl}}/api/reviews/1/likes"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200 또는 201', function () {",
                                    "  pm.expect([200, 201]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "리뷰 좋아요 취소",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": "{{baseUrl}}/api/reviews/1/likes"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200 또는 204', function () {",
                                    "  pm.expect([200, 204]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "즐겨찾기(Favorites)",
            "variable": [
                {
                    "key": "authScope",
                    "value": "user",
                    "type": "string"
                }
            ],
            "item": [
                {
                    "name": "내 즐겨찾기 목록 조회",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": "{{baseUrl}}/api/favorites"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "즐겨찾기 추가",
                    "request": {
                        "method": "POST",
                        "header": [],
                        "url": "{{baseUrl}}/api/favorites/1"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200 또는 201', function () {",
                                    "  pm.expect([200, 201]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "즐겨찾기 삭제",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": "{{baseUrl}}/api/favorites/1"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200 또는 204', function () {",
                                    "  pm.expect([200, 204]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "위시리스트(Wishlist)",
            "variable": [
                {
                    "key": "authScope",
                    "value": "user",
                    "type": "string"
                }
            ],
            "item": [
                {
                    "name": "내 위시리스트 조회",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": "{{baseUrl}}/api/wishlist"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "위시리스트 추가",
                    "request": {
                        "method": "POST",
                        "header": [],
                        "url": "{{baseUrl}}/api/wishlist/1"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200 또는 201', function () {",
                                    "  pm.expect([200, 201]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "위시리스트 삭제",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": "{{baseUrl}}/api/wishlist/1"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200 또는 204', function () {",
                                    "  pm.expect([200, 204]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "출판사(Publishers)",
            "item": [
                {
                    "name": "출판사 목록 조회",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": "{{baseUrl}}/api/publishers"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "출판사 상세 조회",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": "{{baseUrl}}/api/publishers/1"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "카테고리(Categories)",
            "item": [
                {
                    "name": "카테고리 목록 조회",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": "{{baseUrl}}/api/categories"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "카테고리 상세 조회",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": "{{baseUrl}}/api/categories/1"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "작가(Authors)",
            "item": [
                {
                    "name": "작가 목록 조회",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": "{{baseUrl}}/api/authors"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "작가 상세 조회",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": "{{baseUrl}}/api/authors/1"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "시스템(System)",
            "item": [
                {
                    "name": "헬스 체크",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": "{{baseUrl}}/health"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "  pm.expect([200]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "예외 테스트(Errors)",
            "item": [
                {
                    "name": "400 유효하지 않은 입력값(회원가입 - 전화번호 형식 오류)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/auth/signup",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"badphone@example.com\",\n  \"password\": \"password123\",\n  \"username\": \"홍길동\",\n  \"address\": \"서울시\",\n  \"phoneNumber\": \"01012345678\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 400', function () {",
                                    "  pm.expect([400]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "400 비밀번호 불일치(로그인 - 잘못된 비밀번호)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/auth/login",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"test@example.com\",\n  \"password\": \"wrong-password\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 400', function () {",
                                    "  pm.expect([400]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "401 유효하지 않은 토큰(내 정보 조회)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.request.headers.upsert({key:'Authorization', value:'Bearer invalid.token.value'});",
                                    "pm.variables.set('authScope','');"
                                ]
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 401', function () {",
                                    "  pm.expect([401]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": "{{baseUrl}}/api/users/me"
                    }
                },
                {
                    "name": "403 요청 거부됨(일반 사용자 토큰으로 관리자 API 호출)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/categories",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"name\": \"권한없음_카테고리\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.variables.set('authScope','user');"
                                ]
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 403 또는 401', function () {",
                                    "  pm.expect([401,403]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "404 도서를 찾을 수 없음",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": "{{baseUrl}}/api/books/999999"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 404', function () {",
                                    "  pm.expect([404]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "404 출판사를 찾을 수 없음",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": "{{baseUrl}}/api/publishers/999999"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 404', function () {",
                                    "  pm.expect([404]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "404 장바구니 상품을 찾을 수 없음(수량 변경)",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/carts/items/999999",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"quantity\": 1\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.variables.set('authScope','user');"
                                ]
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 404', function () {",
                                    "  pm.expect([404]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "404 리뷰를 찾을 수 없음(리뷰 삭제)",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": "{{baseUrl}}/api/reviews/999999"
                    },
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.variables.set('authScope','user');"
                                ]
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 404', function () {",
                                    "  pm.expect([404]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "409 중복 이메일(1) 회원가입 - 중복용 계정 생성",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/auth/signup",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"{{dupEmail}}\",\n  \"password\": \"password123\",\n  \"username\": \"중복테스트\",\n  \"address\": \"서울시\",\n  \"phoneNumber\": \"010-1111-2222\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 200 또는 409', function () {",
                                    "  pm.expect([200,409]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "409 중복 이메일(2) 회원가입 - 동일 이메일 재시도",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/auth/signup",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"{{dupEmail}}\",\n  \"password\": \"password123\",\n  \"username\": \"중복테스트\",\n  \"address\": \"서울시\",\n  \"phoneNumber\": \"010-1111-2222\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 409', function () {",
                                    "  pm.expect([409]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "409 중복 출판사(1) 출판사 등록 - 중복용 생성(관리자)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/publishers",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"name\": \"{{dupPublisherName}}\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.variables.set('authScope','admin');"
                                ]
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 201 또는 409', function () {",
                                    "  pm.expect([201,409]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "409 중복 출판사(2) 출판사 등록 - 동일 이름 재시도(관리자)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/publishers",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"name\": \"{{dupPublisherName}}\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.variables.set('authScope','admin');"
                                ]
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 409', function () {",
                                    "  pm.expect([409]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "409 중복 카테고리(1) 카테고리 등록 - 중복용 생성(관리자)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/categories",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"name\": \"{{dupCategoryName}}\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.variables.set('authScope','admin');"
                                ]
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 201 또는 409', function () {",
                                    "  pm.expect([201,409]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "409 중복 카테고리(2) 카테고리 등록 - 동일 이름 재시도(관리자)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/categories",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"name\": \"{{dupCategoryName}}\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.variables.set('authScope','admin');"
                                ]
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 409', function () {",
                                    "  pm.expect([409]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "405 허용되지 않은 요청 메서드(/api/users/me에 POST)",
                    "request": {
                        "method": "POST",
                        "header": [],
                        "url": "{{baseUrl}}/api/users/me"
                    },
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 405', function () {",
                                    "  pm.expect([405]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "400 잘못된 요청(장바구니 수량 0으로 추가)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": "{{baseUrl}}/api/carts/items",
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"bookId\": 1,\n  \"quantity\": 0\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        }
                    },
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.variables.set('authScope','user');"
                                ]
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test('Status code is 400', function () {",
                                    "  pm.expect([400]).to.include(pm.response.code);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        }
    ],
    "variable": [
        {
            "key": "baseUrl",
            "value": "http://localhost:8080",
            "type": "string"
        },
        {
            "key": "token",
            "value": "",
            "type": "string"
        },
        {
            "key": "adminToken",
            "value": "",
            "type": "string"
        },
        {
            "key": "refresh_token",
            "value": "",
            "type": "string"
        },
        {
            "key": "adminEmail",
            "value": "admin@example.com",
            "type": "string"
        },
        {
            "key": "adminPassword",
            "value": "P@ssw0rd!",
            "type": "string"
        },
        {
            "key": "dupEmail",
            "value": "duplicate-user@example.com",
            "type": "string"
        },
        {
            "key": "dupPublisherName",
            "value": "중복출판사_테스트",
            "type": "string"
        },
        {
            "key": "dupCategoryName",
            "value": "중복카테고리_테스트",
            "type": "string"
        },
        {
            "key": "adminPublisherName",
            "value": "관리자_출판사",
            "type": "string"
        },
        {
            "key": "adminCategoryName",
            "value": "관리자_카테고리",
            "type": "string"
        },
        {
            "key": "adminAuthorName",
            "value": "관리자_작가",
            "type": "string"
        },
        {
            "key": "adminBookIsbn13",
            "value": "9791162244246",
            "type": "string"
        },
        {
            "key": "adminBookTitle",
            "value": "관리자_도서",
            "type": "string"
        }
    ]
}